{
  "id": "xmas",
  "title": {
    "en": "Christmas"
  },
  "description": {
    "en": "Find christmas trees and more"
  },
  "icon": "./assets/themes/xmas/xmas-tree.svg",
  "startLat": 0,
  "startLon": 0,
  "startZoom": 0,
  "layers": [
    {
      "id": "xmas_trees",
      "name": {
        "en": "Christmas trees"
      },
      "description": {
        "en": "Layer with christmas trees"
      },
      "minzoom": 12,
      "source": {
        "osmTags": "xmas:feature=tree"
      },
      "title": {
        "render": {
          "en": "Christmas tree"
        }
      },
      "tagRenderings": [
        {
          "id": "last_check",
          "freeform": {
            "key": "survey:date",
            "type": "date"
          },
          "render": {
            "en": "Last checked on {survey:date}"
          },
          "mappings": [
            {
              "if": "survey:date={_now:date}",
              "then": "Checked today!"
            }
          ],
          "question": {
            "en": "When was this tree last checked?"
          }
        }
      ],
      "allowMove": {
        "enableImproveAccuracy": true
      },
      "deletion": true,
      "filter": [
        {
          "id": "recently_surveyed",
          "options": [
            {
              "default": true,
              "question": {
                "en": "Show all trees"
              }
            },
            {
              "osmTags": "_recently_surveyed=true",
              "question": {
                "en": "Show only recently surveyed trees"
              }
            },
            {
              "osmTags": "_recently_surveyed=false",
              "question": {
                "en": "Show only trees that have not been surveyed recently"
              }
            }
          ]
        }
      ],
      "mapRendering": [
        {
          "icon": "./assets/themes/xmas/xmas-tree.svg",
          "location": [
            "point",
            "centroid"
          ],
          "iconBadges": [
            {
              "if": "_recently_surveyed=false",
              "then": "circle:red"
            },
            {
              "if": "_recently_surveyed=true",
              "then": "circle:green"
            }
          ]
        }
      ],
      "presets": [
        {
          "tags": [
            "xmas:feature=tree"
          ],
          "title": {
            "en": "a christmas tree"
          },
          "description": {
            "en": "A public, usually large christmas tree"
          }
        }
      ],
      "calculatedTags": [
        "_days_since_last_survey=Math.floor(new Date() - new Date(feat.properties['survey:date'])/(1000*60*60*24))",
        "_recently_surveyed=Number(feat.properties._days_since_last_survey) <= 90"
      ]
    }
  ]
}