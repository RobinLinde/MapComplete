{
  "id": "xmas",
  "title": {
    "en": "Christmas"
  },
  "description": {
    "en": "Find christmas trees and more"
  },
  "icon": "./assets/themes/xmas/xmas-tree.svg",
  "startLat": 0,
  "startLon": 0,
  "startZoom": 0,
  "layers": [
    {
      "id": "xmas_trees",
      "name": {
        "en": "Christmas trees"
      },
      "description": {
        "en": "Layer with christmas trees"
      },
      "minzoom": 12,
      "source": {
        "osmTags": "xmas:feature=tree"
      },
      "title": {
        "render": {
          "en": "Christmas tree"
        }
      },
      "tagRenderings": [
        {
          "id": "last_check",
          "freeform": {
            "key": "survey:date",
            "type": "date",
            "placeholder": {
              "en": "Last time this tree was checked"
            }
          },
          "render": {
            "en": "Last checked on {survey:date}"
          },
          "mappings": [
            {
              "if": "survey:date={_now:date}",
              "then": "Checked today!"
            }
          ],
          "question": {
            "en": "When was this tree last checked?"
          }
        }
      ],
      "allowMove": {
        "enableImproveAccuracy": true
      },
      "deletion": true,
      "filter": [
        {
          "id": "recently_surveyed",
          "options": [
            {
              "default": true,
              "question": {
                "en": "Show all trees"
              }
            },
            {
              "osmTags": "_recently_surveyed=true",
              "question": {
                "en": "Show only recently surveyed trees"
              }
            },
            {
              "osmTags": "_recently_surveyed=false",
              "question": {
                "en": "Show only trees that have not been surveyed recently"
              }
            }
          ]
        }
      ],
      "mapRendering": [
        {
          "icon": "./assets/themes/xmas/xmas-tree.svg",
          "location": [
            "point",
            "centroid"
          ]
        }
      ],
      "presets": [
        {
          "tags": [
            "xmas:feature=tree"
          ],
          "title": {
            "en": "a christmas tree"
          },
          "description": {
            "en": "A public, usually large christmas tree"
          }
        }
      ],
      "calculatedTags": [
        "_days_since_last_survey=Math.floor((new Date() - new Date(feat.properties['survey:date']))/(1000*60*60*24))",
        "_recently_surveyed=Number(feat.properties._days_since_last_survey) <= 90"
      ]
    },
    {
      "id": "xmas_markets",
      "name": {
        "en": "Christmas markets"
      },
      "description": {
        "en": "Layer with christmas markets"
      },
      "minzoom": 12,
      "source": {
        "osmTags": "xmas:feature=market"
      },
      "title": {
        "render": {
          "en": "Christmas market"
        },
        "mappings": [
          {
            "if": "name={name}",
            "then": "{name}"
          }
        ]
      },
      "tagRenderings": [
        {
          "id": "name",
          "freeform": {
            "key": "name",
            "type": "string",
            "placeholder": {
              "en": "Name of the market"
            }
          },
          "render": {
            "en": "This market is called {name}"
          },
          "question": {
            "en": "What is the name of this market?"
          }
        },
        {
          "id": "date",
          "freeform": {
            "key": "xmas:day_date",
            "type": "date",
            "placeholder": {
              "en": "Dates of the market (e.g. 2022-12-01 - 2022-12-24)"
            }
          },
          "render": {
            "en": "The market is on {xmas:day_date}"
          },
          "question": {
            "en": "When does this market take place?"
          }
        },
        {
          "id": "last_check",
          "freeform": {
            "key": "survey:date",
            "type": "date",
            "placeholder": {
              "en": "Last time this market was checked"
            }
          },
          "render": {
            "en": "Last checked on {survey:date}"
          },
          "mappings": [
            {
              "if": "survey:date={_now:date}",
              "then": "Checked today!"
            }
          ],
          "question": {
            "en": "When was this market last checked?"
          }
        }
      ],
      "allowMove": {
        "enableImproveAccuracy": true
      },
      "deletion": true,
      "filter": [
        {
          "id": "recently_surveyed",
          "options": [
            {
              "default": true,
              "question": {
                "en": "Show all markets"
              }
            },
            {
              "osmTags": "_recently_surveyed=true",
              "question": {
                "en": "Show only recently surveyed markets"
              }
            },
            {
              "osmTags": "_recently_surveyed=false",
              "question": {
                "en": "Show only markets that have not been surveyed recently"
              }
            }
          ]
        }
      ],
      "mapRendering": [
        {
          "icon": "./assets/themes/xmas/xmas-market.svg",
          "location": [
            "point",
            "centroid"
          ]
        }
      ],
      "presets": [
        {
          "tags": [
            "xmas:feature=market"
          ],
          "title": {
            "en": "a christmas market"
          }
        }
      ],
      "calculatedTags": [
        "_days_since_last_survey=Math.floor((new Date() - new Date(feat.properties['survey:date']))/(1000*60*60*24))",
        "_recently_surveyed=Number(feat.properties._days_since_last_survey) <= 90"
      ]
    },
    {
      "id": "xmas_tree_shops",
      "name": {
        "en": "Christmas tree shops"
      },
      "description": {
        "en": "Layer showing places selling christmas trees"
      },
      "minzoom": 12,
      "source": {
        "osmTags": {
          "and": [
            "xmas:feature=shop",
            "xmas:feature:shop=christmas_tree"
          ]
        }
      },
      "title": {
        "render": {
          "en": "Christmas tree shop"
        },
        "mappings": [
          {
            "if": "name~*",
            "then": "{name}"
          }
        ]
      },
      "tagRenderings": [
        {
          "id": "name",
          "freeform": {
            "key": "name",
            "type": "string",
            "placeholder": {
              "en": "Name of the shop"
            }
          },
          "render": {
            "en": "This shop is called {name}"
          },
          "question": {
            "en": "What is the name of this shop?"
          }
        },
        {
          "id": "last_check",
          "freeform": {
            "key": "xmas:lastcheck",
            "type": "date",
            "placeholder": {
              "en": "Last time this shop was checked"
            }
          },
          "render": {
            "en": "Last checked on {xmas:lastcheck}"
          },
          "mappings": [
            {
              "if": "xmas:lastcheck={_now:date}",
              "then": "Checked today!"
            }
          ],
          "question": {
            "en": "When was this shop last checked?"
          }
        },
        "opening_hours"
      ],
      "allowMove": {
        "enableImproveAccuracy": true
      },
      "deletion": false,
      "filter": [
        {
          "id": "recently_surveyed",
          "options": [
            {
              "default": true,
              "question": {
                "en": "Show all shops"
              }
            },
            {
              "osmTags": "_recently_surveyed=true",
              "question": {
                "en": "Show only recently surveyed shops"
              }
            },
            {
              "osmTags": "_recently_surveyed=false",
              "question": {
                "en": "Show only shops that have not been surveyed recently"
              }
            }
          ]
        }
      ],
      "mapRendering": [
        {
          "icon": "./assets/layers/id_presets/maki-shop.svg",
          "location": [
            "point",
            "centroid"
          ],
          "iconBadges": [
            {
              "if": "opening_hours~*",
              "then": "isOpen"
            }
          ]
        }
      ],
      "presets": [
        {
          "tags": [
            "xmas:feature=shop",
            "xmas:feature:shop=christmas_tree"
          ],
          "title": {
            "en": "a christmas tree shop"
          },
          "description": {
            "en": "A shop selling christmas trees"
          }
        }
      ],
      "calculatedTags": [
        "_days_since_last_survey=Math.floor((new Date() - new Date(feat.properties['xmas:lastcheck']))/(1000*60*60*24))",
        "_recently_surveyed=Number(feat.properties._days_since_last_survey) <= 90"
      ]
    }
  ]
}